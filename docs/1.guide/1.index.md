---
icon: ph:book-open-duotone
---

# Getting Started Guide

> Learn how to set up and use unstorage in your projects.

## Introduction

We typically choose one or more storage backends based on our use cases, such as file systems, databases, or a browser's LocalStorage. Problems quickly arise when trying to support and combine multiple options or switch between them. For authors of JavaScript libraries, this often means deciding how many platforms to support and implementing storage for each platform.

## Installation

Install the [`unstorage`](https://npmjs.com/package/unstorage) npm package:

:pm-install{name="unstorage"}

## Usage

```js [my-storage.js]
import { createStorage } from "unstorage";

const storage = createStorage(/* opts */);

await storage.getItem("foo:bar"); // or storage.getItem('/foo/bar')
```

**Options:**

- `driver`: The default driver, which uses [memory](/drivers/memory) if not provided.

## API

### `hasItem(key, opts?)`

Checks if a certain key exists in storage. Returns `true` or `false`.

```js
await storage.hasItem("foo:bar");
```

You can also use the `has` alias:

```js
await storage.has("foo:bar");
```

### `getItem(key, opts?)`

Retrieves the value for a certain key in storage. Returns a JavaScript primitive value or `null`.

```js
await storage.getItem("foo:bar");
```

You can also use the `get` alias:

```js
await storage.get("foo:bar");
```

### `getItems(items, opts)`

(Experimental) Retrieves values for multiple keys in storage in parallel.

Each item in the array can be a string or an object in the format `{ key, options? }`.

The returned value is a Promise that resolves to an array of objects in the format `{ key, value }`.

### `getItemRaw(key, opts?)`

**Note:** This is an experimental feature. Please see [unjs/unstorage#142](https://github.com/unjs/unstorage/issues/142) for more information.

Retrieves the value for a certain key in storage in its raw format.

```js
// The value can be a Buffer, Array, or the raw format of the driver
const value = await storage.getItemRaw("foo:bar.bin");
```

### `setItem(key, value, opts?)`

Adds/updates a value in storage.

If the value is not a string, it will be converted to a string.

If the value is `undefined`, it is equivalent to calling `removeItem(key)`.

```js
await storage.setItem("foo:bar", "baz");
```

You can also use the `set` alias:

```js
await storage.set("foo:bar", "baz");
```

### `setItems(items, opts)`

(Experimental) Adds/updates items in storage in parallel.

Each item in the `items` array should be in the format `{ key, value, options? }`.

The returned value is a Promise that resolves to an array of objects in the format `{ key, value }`.

### `setItemRaw(key, value, opts?)`

**Note:** This is an experimental feature. Please see [unjs/unstorage#142](https://github.com/unjs/unstorage/issues/142) for more information.

Adds/updates a value in storage in its raw format.

If the value is `undefined`, it is equivalent to calling `removeItem(key)`.

```js
await storage.setItemRaw("data/test.bin", new Uint8Array([1, 2, 3]));
```

### `removeItem(key, opts = { removeMeta = false })`

Removes a value (and its metadata) from storage.

```js
await storage.removeItem("foo:bar", { removeMeta: true });
// Equivalent to await storage.removeItem("foo:bar", true);
```

You can also use the `del` or `remove` aliases:

```js
await storage.remove("foo:bar");
await storage.del("foo:bar");
```

### `getMeta(key, opts = { nativeOnly? })`

Gets the metadata object for a specific key.

This data comes from two sources:

- The driver's native metadata (like the file creation time)
- Custom metadata set via `storage.setMeta` (overrides the driver's native metadata)

```js
await storage.getMeta("foo:bar"); // For the fs driver, returns an object like { mtime, atime, size }
```

### `setMeta(key, opts?)`

Sets custom metadata for a specific key by adding a `$` suffix.

```js
await storage.setMeta("foo:bar", { flag: 1 });
// Equivalent to storage.setItem('foo:bar$', { flag: 1 })
```

### `removeMeta(key, opts?)`

Removes metadata for a specific key by adding a `$` suffix.

```js
await storage.removeMeta("foo:bar");
// Equivalent to storage.removeItem('foo:bar$')
```

### `getKeys(base?, opts?)`

Gets all keys. Returns an array of strings.

Metadata keys (ending with `$`) will be filtered out.

If a base is provided, only keys starting with the base will be returned, and only mounts starting with the base will be queried. Keys still have the full path.

```js
await storage.getKeys();
```

You can also use the `keys` alias:

```js
await storage.keys();
```

### `clear(base?, opts?)`

Removes all stored key/value pairs. If a base is provided, only mounts matching the base will be cleared.

```js
await storage.clear();
```

### `dispose()`

Disposes of all mounted storage to ensure no open handles are left. Call this before exiting the process.

**Note:** Disposal also clears data in memory.

```js
await storage.dispose();
```

### `mount(mountpoint, driver)`

By default, everything is stored in memory. We can mount additional storage in a Unix-like fashion.

When operations are performed with keys starting with the mountpoint, the mounted driver is called instead of the default storage.

In addition to `base`, you can set `readOnly` and `noClear` to disable write and clear operations.

```js
import { createStorage } from "unstorage";
import fsDriver from "unstorage/drivers/fs";

// Create a storage container with default memory storage
const storage = createStorage({});

storage.mount("/output", fsDriver({ base: "./output" }));

// Write to the ./output/test file
await storage.setItem("/output/test", "works");

// Add value to memory storage
await storage.setItem("/foo", "bar");
```

### `unmount(mountpoint, dispose = true)`

Unregisters a mount point. Invalid if the mount point is not found or is root.

```js
await storage.unmount("/output");
```

### `watch(callback)`

Starts watching all mount points. If the driver does not support watching, events are emitted only when calling `storage.*` methods.

```js
const unwatch = await storage.watch((event, key) => {});
// Stop this watcher
await unwatch();
```

### `unwatch()`

Stops all watchers across all mount points.

```js
await storage.unwatch();
```

### `getMount(key)`

Gets the mount point (driver and base) for a specific key in storage.

```js
storage.mount("cache" /* ... */);
storage.mount("cache:routes" /* ... */);

storage.getMount("cache:routes:foo:bar");
// => { base: "cache:routes:", driver: "..." }
```

### `getMounts(base?, { parents: boolean }?)`

Gets the mount points for a specific base.

```js
storage.mount("cache" /* ... */);
storage.mount("cache:sub" /* ... */);

storage.getMounts("cache:sub");
// => [{ base: "cache:sub", driver }]

storage.getMounts("cache:");
// => [{ base: "cache:sub", driver }, { base: "cache:", driver }]

storage.getMounts("");
storage.getMounts("cache:sub", { parents: true });
// => [{ base: "cache:sub", driver }, { base: "cache:", driver }, { base: "", driver }]
```

## Generic Types

**Return type of `getItem`:**

```ts
await storage.getItem<string>("k"); // => <string>

await storage.getItemRaw<Buffer>("k"); // => <Buffer>
```

**Type checking for `setItem` parameters:**

```ts
storage.setItem<string>("k", "val"); // Check passes
storage.setItemRaw<string>("k", "val"); // Check passes

storage.setItem<string>("k", 123); // ts error
storage.setItemRaw<string>("k", 123); // ts error
```

**Type storage instance:**

```ts
const storage = createStorage<string>();

await storage.getItem("k"); // => <string>

storage.setItem("k", "val"); // Check passes
storage.setItem("k", 123); // TS error
```

::note
Forward references use inheritance rather than overwriting types.
::

```ts
const storage = createStorage<string>();

storage.setItem<number>("k", 123); // TS error: <number> is not assignable to <string>
```

**Using `prefixStorage` to specify subset types:**

```ts
const storage = createStorage();

const htmlStorage = prefixStorage<string>(storage, "assets:html");

await htmlStorage.getItem("foo.html"); // => <string>

type Post = {
  title: string;
  content: string;
};

const postStorage = prefixStorage<Post>(storage, "assets:posts");

await postStorage.getItem("foo.json"); // => <Post>
```

In [strict mode](https://www.typescriptlang.org/tsconfig#strict), it will also return the `null` type to help you handle missing cases with `getItem`.

```ts
"use strict";

await storage.getItem<string>("k"); // => <string | null>
```

**Specifying namespace:**

```ts
type StorageDefinition = {
  items: {
    foo: string;
    baz: number;
  }
}

const storage = createStorage<StorageDefinition>();
await storage.has("foo"); // TS will suggest you have two optional keys: "foo" or "baz"
await storage.getItem("baz"); // => string
await storage.setItem("foo", 12); // TS error: <number> is not assignable to <string>
await storage.setItem("foo", "val"); // Check passes
await storage.remove("foo");